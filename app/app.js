angular.module("codexen",["codexen.shared","ngSanitize","ui.select","ui.ace","ui.router","ui.bootstrap","satellizer","angular-md5","templates"]).constant("appName","main"),angular.module("templates",[]),angular.module("codexen").config(["$stateProvider","$urlRouterProvider","$httpProvider",function(e,n,t){t.interceptors.push(["$q","$injector",function(e,n){return{responseError:function(t){switch(t.status){case 401:var i=n.get("$state");i.go("auth.signin")}return e.reject(t)}}}]),n.when("/auth","/auth/register").when("/auth/","/auth/register").otherwise("/"),e.state("auth",{url:"/auth",views:{"main-view":{templateUrl:"tpls/states/auth.tpl.html"}}}).state("auth.register",{url:"/register",templateUrl:"tpls/states/auth.register.tpl.html",controller:"AuthRegisterController as vm"}).state("auth.signin",{url:"/signin",templateUrl:"tpls/states/auth.signin.tpl.html",controller:"AuthSignInController as vm"}).state("settings",{url:"/settings",views:{"main-view":{templateUrl:"tpls/states/settings.tpl.html",controller:"SettingsController as vm"}}}).state("snippets",{url:"/snippets",views:{"main-view":{templateUrl:"tpls/states/snippets.list.tpl.html",controller:"SnippetsListController as vm"}},resolve:{mySnippets:["Snippet",function(e){return e.findMine().then(function(e){return e.data})}]}}).state("snippets.detail",{url:"/:id",templateUrl:"tpls/states/snippets.detail.tpl.html",controller:"SnippetsDetailController as vm"}).state("home",{url:"/",views:{"main-view":{templateUrl:"tpls/states/home.tpl.html",controller:"HomeController as vm"}}}).state("recipes",{url:"/recipes",views:{"main-view":{templateUrl:"tpls/states/recipes.list.tpl.html",controller:"RecipesListController as vm"}},resolve:{myRecipes:["Recipe",function(e){return e.findMine().then(function(e){return e.data})}]}}).state("recipes.detail",{url:"/:id",templateUrl:"tpls/states/recipes.detail.html",controller:"RecipesDetailController as vm"})}]),angular.module("codexen").controller("AppController",["$scope",function(e){}]),angular.module("codexen").directive("btnDeleteRecipe",["Modal","$rootScope",function(e,n){return{scope:{recipe:"=btnDeleteRecipe"},link:function(n,t){t.on("click",function(){e.deleteRecipe(n.recipe).then(function(e){console.log("deleted",e)},function(){console.log("delete snippet modal dismissed")})})}}}]),angular.module("codexen").directive("btnDeleteSnippet",["Modal","$rootScope",function(e,n){return{scope:{snippet:"=btnDeleteSnippet"},link:function(n,t){t.on("click",function(){e.deleteSnippet(n.snippet).then(function(e){console.log("deleted",e)},function(){console.log("delete snippet modal dismissed")})})}}}]),angular.module("codexen").directive("btnEditRecipe",["Modal",function(e){return{scope:{recipe:"=btnEditRecipe"},link:function(n,t){t.on("click",function(){e.editRecipe(angular.copy(n.recipe))})}}}]),angular.module("codexen").directive("btnEditSnippet",["Modal",function(e){return{scope:{snippet:"=btnEditSnippet"},link:function(n,t){t.on("click",function(){e.editSnippet(angular.copy(n.snippet))})}}}]),angular.module("codexen").directive("btnExpandRecipe",["Modal",function(e){return{restrict:"A",scope:{recipe:"=btnExpandRecipe"},link:function(n,t){t.on("click",function(){e.expandRecipe(n.recipe)})}}}]),angular.module("codexen").directive("btnNewRecipe",["Modal",function(e){return{restrict:"A",link:function(n,t){t.on("click",function(){e.newRecipe()})}}}]),angular.module("codexen").directive("btnNewSnippet",["Modal","$rootScope",function(e,n){return{link:function(n,t){t.on("click",function(){e.newSnippet()})}}}]),angular.module("codexen").directive("recipeItem",["Modal","$rootScope",function(e,n){return{restrict:"A",transclude:!0,template:"<div ng-transclude></div>",scope:{recipe:"=recipeItem"},link:function(n,t){n.$on("taggingRequested",function(t){t.stopPropagation(),t.preventDefault(),e.editRecipe(angular.copy(n.recipe))})}}}]),angular.module("codexen").directive("sideNav",function(){return{templateUrl:"tpls/directives/side-nav.tpl.html",controller:"SideNavController as vm"}}),angular.module("codexen").directive("snippetItem",["Modal","$rootScope",function(e,n){return{restrict:"A",transclude:!0,template:"<div ng-transclude></div>",scope:{snippet:"=snippetItem"},link:function(n,t){n.$on("taggingRequested",function(t){t.stopPropagation(),t.preventDefault(),e.editSnippet(angular.copy(n.snippet))})}}}]),angular.module("codexen").directive("tagItem",function(){return{restrict:"A",template:'#<span ng-bind="tag.name"></span>',scope:{tag:"=tagItem"},link:function(e,n){n.on("click",function(){e.$emit("tagSelected",e.tag)})}}}),angular.module("codexen").directive("tagList",function(){return{restrict:"A",template:'<p class="tags"><i class="fa fa-tags"></i> <a tag-item="tag" ng-repeat="tag in tags" href></a><a ng-if="!tags.length" ng-click="requestTagging($event)" href> Not tagged yet</a></p>',scope:{tags:"=tagList"},link:function(e,n){n.ready(function(){n.find("a").on("click",function(e){e.stopPropagation()})}),e.requestTagging=function(n){n.preventDefault(),n.stopPropagation(),e.$emit("taggingRequested")}}}}),angular.module("codexen").filter("fromNow",function(){return function(e){return moment(e).fromNow()}}),angular.module("codexen").filter("marked",function(){return marked.setOptions({renderer:new marked.Renderer,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!0,smartLists:!0,smartypants:!1}),function(e){return angular.isString(e)||(e=""),marked(e)}}),angular.module("codexen").filter("searchSnippets",["$filter",function(e){return function(n,t){if(!angular.isString(t)||!angular.isArray(n))return angular.copy(n);if(t.match(/#(.+)|tag:(.+)/)){var i=t.match(/#(.+)/)?t.match(/#(.+)/)[1]:t.match(/tag:(.+)/)[1];return n.filter(function(e){return e.Tags.some(function(e){return e.name.match(new RegExp("^"+i))})})}return e("filter")(n,t)}}]),angular.module("codexen").factory("Modal",["$modal","$rootScope","$auth",function(e,n,t){var i=function(){return e.open({templateUrl:"tpls/modals/regulation.html",controller:"AgreementModalController as vm"}).result},r=function(){return e.open({templateUrl:"tpls/modals/regulation.html",controller:"PPModalController as vm"})},o=function(){return e.open({templateUrl:"tpls/modals/pp.html",controller:"PPModalController as vm"})},a=function(){return e.open({templateUrl:"tpls/modals/sign-out-modal.html",controller:"SignOutModalController as vm"}).result.then(function(){t.logout().then(function(){console.log("Sign Out"),n.$broadcast("userSignOut")})})},s=function(){return e.open({templateUrl:"tpls/modals/new-recipe-modal.html",controller:"NewRecipeModalController as vm"}).result.then(function(e){n.$broadcast("recipeUpdated",e)})},l=function(t){return e.open({resolve:{recipe:function(){return t}},templateUrl:"tpls/modals/edit-recipe-modal.html",controller:"EditRecipeModalController as vm"}).result.then(function(e){n.$broadcast("recipeUpdated",e)})},c=function(n){return e.open({size:"lg",resolve:{recipe:function(){return n}},templateUrl:"tpls/modals/expand-recipe-modal.html",controller:"ExpandRecipeModalController as vm"})},u=function(t){return e.open({resolve:{recipe:function(){return t}},templateUrl:"tpls/modals/delete-recipe-modal.html",controller:"DeleteRecipeModalController as vm"}).result.then(function(e){n.$broadcast("recipeDeleted",e)})},d=function(){return e.open({templateUrl:"tpls/modals/new-snippet-modal.tpl.html",controller:"NewSnippetModalController as vm"}).result.then(function(e){n.$broadcast("snippetUpdated",e)})},p=function(t){return e.open({resolve:{snippet:function(){return t}},templateUrl:"tpls/modals/edit-snippet-modal.tpl.html",controller:"EditSnippetModalController as vm"}).result.then(function(e){n.$broadcast("snippetUpdated",e)})},f=function(t){return e.open({resolve:{snippet:function(){return t}},templateUrl:"tpls/modals/delete-snippet-modal.tpl.html",controller:"DeleteSnippetModalController as vm"}).result.then(function(e){n.$broadcast("snippetDeleted",e)})},m=function(n){return e.open({templateUrl:"tpls/modals/select-snippet-modal.html",controller:"SelectSnippetModalController as vm"}).result};return{showAgreement:i,showRegulation:r,showPP:o,signOut:a,newRecipe:s,editRecipe:l,deleteRecipe:u,expandRecipe:c,newSnippet:d,editSnippet:p,deleteSnippet:f,selectSnippet:m}}]),angular.module("codexen").factory("Recipe",["$http","$auth","apiUrl",function(e,n,t){var i=function(n){var i=t+"blueprints/search";return e.get(i,{params:{user:n}})},r=function(n){var i=t+"blueprints/my";return e.get(i,{params:n})},o=function(n){var i=t+"blueprints/create";return e.post(i,n)},a=function(n,i){var r=t+"blueprints/id/"+n;return e.get(r,{params:i})},s=function(n,i){var r=t+"blueprints/id/"+n;return e.put(r,i)},l=function(n){var i=t+"blueprints/id/"+n;return e["delete"](i)};return{findByUser:i,findMine:r,create:o,show:a,"delete":l,update:s}}]),angular.module("codexen").factory("Settings",["$http","apiUrl",function(e,n){var t=function(t){var i=n+"settings/change_password";return e.post(i,t)};return{changePassword:t}}]),angular.module("codexen").factory("Tag",["$http","apiUrl",function(e,n){var t=function(t){var i=n+"tags/search";return e.get(i,{params:{name:t}})};return{findByName:t}}]),angular.module("codexen").factory("User",["$http","apiUrl","$rootScope","$state",function(e,n,t,i){t.$on("userSignOut",function(){i.go("auth.signin")});var r=function(){var t=n+"auth/user";return e.get(t)};return{me:r}}]),angular.module("codexen").controller("SideNavController",["$auth","User","$rootScope","$scope","Modal",function(e,n,t,i,r){var o=this;o.isAuthenticated=e.isAuthenticated(),o.showPP=r.showPP,o.showRegulation=r.showRegulation;var a=function(){o.isAuthenticated&&n.me().success(function(e){console.log("currentUser",e),o.currentUser=e})};a(),o.signOut=function(){r.signOut()},i.$on("userSignIn",function(){o.isAuthenticated=!0,a()}),i.$on("userSignOut",function(){o.isAuthenticated=!1,o.currentUser=null})}]),angular.module("codexen").controller("AgreementModalController",["$modalInstance",function(e){var n=this;n.isAgreement=!0,n.submit=function(){e.close()},n.cancel=function(){e.dismiss("cancel")}}]),angular.module("codexen").controller("DeleteRecipeModalController",["$modalInstance","Recipe","recipe",function(e,n,t){var i=this;i.submit=function(){n["delete"](t.id).success(function(n){e.close(n)})},i.cancel=function(){e.dismiss()}}]),angular.module("codexen").controller("DeleteSnippetModalController",["$modalInstance","Snippet","snippet",function(e,n,t){var i=this;i.submit=function(){n["delete"](t.id).success(function(n){e.close(n)})},i.cancel=function(){e.dismiss()}}]),angular.module("codexen").controller("EditRecipeModalController",["Recipe","Tag","$modalInstance","recipe",function(e,n,t,i){var r=this;r.recipe=i,r.submit=function(){var n={title:r.recipe.title,content:r.recipe.content,Tags:angular.isArray(r.recipe.Tags)?r.recipe.Tags.map(function(e){return e.name}):[]};e.update(r.recipe.id,n).success(function(e){t.close(e)})},r.tagCandidates=[],r.refreshTagCandidates=function(e){return null==e||""===e?null:n.findByName(e).success(function(e){console.log("tags fetched!!",e),r.tagCandidates=e})},r.transform=function(e){return{id:0,name:e}},r.cancel=function(){t.dismiss()}}]),angular.module("codexen").controller("EditSnippetModalController",["$modalInstance","aceModes","$log","Snippet","$rootScope","Tag","snippet",function(e,n,t,i,r,o,a){var s=this;s.aceModes=n,s.snippet=a,s.submit=function(){var n={description:s.snippet.description,callSign:s.snippet.callSign,mode:null==s.snippet.mode?null:s.snippet.mode.toLowerCase(),content:s.snippet.content,Tags:angular.isArray(s.snippet.Tags)?s.snippet.Tags.map(function(e){return e.name}):[]};i.update(s.snippet.id,n).success(function(n){console.log("updated res :",n),r.$broadcast("snippetUpdated",a),e.close(n)})},s.tagCandidates=[],s.refreshTagCandidates=function(e){return null==e||""===e?null:o.findByName(e).success(function(e){console.log("tags fetched!!",e),s.tagCandidates=e})},s.transform=function(e){return{id:0,name:e}},s.cancel=function(){e.dismiss()}}]),angular.module("codexen").controller("ExpandRecipeModalController",["recipe","$modalInstance","$scope","Modal",function(e,n,t,i){var r=this;console.log(e),r.recipe=e,r.cancel=function(){n.dismiss("cancel")},r.insert=function(e){t.$broadcast("insertRequested",e)},r.insertSnippet=function(){i.selectSnippet().then(function(e){t.$broadcast("insertSnippetRequested",e)})}}]),angular.module("codexen").controller("NewRecipeModalController",["Recipe","Tag","$modalInstance",function(e,n,t){var i=this;i.recipe={},i.submit=function(){var n={title:i.recipe.title,content:i.recipe.content,Tags:angular.isArray(i.recipe.Tags)?i.recipe.Tags.map(function(e){return e.name}):[]};e.create(n).success(function(e){t.close(e)})},i.tagCandidates=[],i.refreshTagCandidates=function(e){return null==e||""===e?null:n.findByName(e).success(function(e){console.log("tags fetched!!",e),i.tagCandidates=e})},i.transform=function(e){return{id:0,name:e}},i.cancel=function(){t.dismiss()}}]),angular.module("codexen").controller("NewSnippetModalController",["$modalInstance","aceModes","$log","Snippet","Tag",function(e,n,t,i,r){var o=this;o.aceModes=n,o.submit=function(){var n={description:o.description,callSign:o.callSign,mode:null==o.mode?null:o.mode.toLowerCase(),content:o.content,Tags:angular.isArray(o.Tags)?o.Tags.map(function(e){return e.name}):[]};i.create(n).success(function(n){e.close(n)})},o.tagCandidates=[],o.refreshTagCandidates=function(e){return null==e||""===e?null:r.findByName(e).success(function(e){console.log("tags fetched!!",e),o.tagCandidates=e})},o.transform=function(e){return{id:0,name:e}},o.cancel=function(){e.dismiss()}}]),angular.module("codexen").controller("PPModalController",["$modalInstance",function(e){var n=this;n.isAgreement=!1,n.cancel=function(){e.dismiss("cancel")}}]),angular.module("codexen").controller("SelectSnippetModalController",["Snippet","$modalInstance",function(e,n){var t=this;t.select=function(e){n.close(e)},t.cancel=function(){n.dismiss("cancel")},e.findMine().success(function(e){t.snippets=e})}]),angular.module("codexen").controller("SignOutModalController",["$modalInstance",function(e){var n=this;n.submit=function(){e.close()},n.cancel=function(){e.dismiss("cancel")}}]),angular.module("codexen").controller("AuthRegisterController",["$auth","$log","$state","$rootScope","Modal",function(e,n,t,i,r){var o=this;o.isEmpty=function(e){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0},o.signup=function(){r.showAgreement().then(function(){e.signup({email:o.email,password:o.password,name:o.name,profileName:o.profileName}).then(function(e){i.$broadcast("userSignIn"),t.go("home")})})}}]),angular.module("codexen").controller("AuthSignInController",["$auth","$rootScope",function(e,n){var t=this;t.authFailed=!1,t.signIn=function(){t.authFailed=!1,e.login({email:t.email,password:t.password}).then(function(e){console.log(e),n.$broadcast("userSignIn")},function(e){console.log(e),t.authFailed=!0})}}]),angular.module("codexen").controller("HomeController",["$auth","Snippet","$scope",function(e,n,t){}]),angular.module("codexen").controller("RecipesDetailController",["Recipe","$state","$rootScope","$scope","Modal",function(e,n,t,i,r){var o=this;o.isLoaded=!1;var a=n.params.id;e.show(a).success(function(e){o.recipe=e,o.isLoaded=!0}),i.$on("taggingRequested",function(e){e.stopPropagation(),e.preventDefault(),r.editRecipe(angular.copy(o.recipe)).then(function(e){console.log("edited",e)},function(){console.log("edit recipe modal dismissed")})}),i.$on("recipeUpdated",function(e,n){console.log("event received",n),n.id===o.recipe.id&&(o.recipe=n)})}]),angular.module("codexen").controller("RecipesListController",["Recipe","$state","$scope","$filter","myRecipes","User","$auth",function(e,n,t,i,r,o,a){function s(){l.filtered=i("searchSnippets")(r,l.search),l.search&&l.filtered&&l.filtered[0]&&(!l.recipeId||l.recipeId!==l.filtered[0].id)&&n.go("recipes.detail",{id:l.filtered[0].id})}var l=this;l.recipes=r,l.searchRecipes=s,l.searchRecipes(),l.isAuthenticated=a.isAuthenticated();var c=function(){l.isAuthenticated&&o.me().success(function(e){l.currentUser=e})};c(),t.$on("$stateChangeSuccess",function(e,t,i){return t.name.match(/recipes/)?(l.recipeId=parseInt(i.id,10),void(!l.recipeId&&l.filtered&&l.filtered[0]&&n.go("recipes.detail",{id:l.filtered[0].id}))):null}),t.$on("recipeUpdated",function(e,t){r.some(function(e,n){return e.id===t.id?(r[n]=t,!0):!1})||r.unshift(t),s(),l.recipeId=t.id,n.go("recipes.detail",{id:t.id})}),t.$on("recipeDeleted",function(){if(n.is("recipes.detail")){for(var e=parseInt(n.params.id,10),t=0;t<l.recipes.length;t++)if(l.recipes[t].id===e){l.recipes.splice(t,1);break}for(t=0;t<l.filtered.length;t++)if(l.filtered[t].id===e){null!=l.filtered[t+1]?n.go("recipes.detail",{id:l.filtered[t+1].id}):null!=l.filtered[t-1]?n.go("recipes.detail",{id:l.filtered[t-1].id}):n.go("recipes"),l.filtered.splice(t,1);break}}}),t.$on("tagSelected",function(e,n){e.stopPropagation(),t.$apply(function(){l.search="#"+n.name,s()})})}]),angular.module("codexen").controller("SettingsController",["Settings",function(e){function n(){var n={password:i.password,newPassword:i.newPassword};e.changePassword(n).success(function(e){t(),i.isSuccess=!0,i.isError=!1}).error(function(){t(),i.isError=!0,i.isSuccess=!1})}function t(){i.password="",i.newPassword=""}var i=this;i.changePassword=n,i.isSuccess=!1,i.isError=!1}]),angular.module("codexen").controller("SnippetsDetailController",["Snippet","$state","$rootScope","$scope","Modal",function(e,n,t,i,r){var o=this;o.isLoaded=!1;var a=n.params.id;e.show(a).success(function(e){o.snippet=e,o.isLoaded=!0}),i.$on("taggingRequested",function(e){e.stopPropagation(),e.preventDefault(),r.editSnippet(angular.copy(o.snippet)).then(function(e){console.log("edited",e)},function(){console.log("edit snippet modal dismissed")})}),i.$on("snippetUpdated",function(e,n){console.log("event received",n),n.id===o.snippet.id&&(o.snippet=n)})}]),angular.module("codexen").controller("SnippetsListController",["$auth","Snippet","$scope","$state","$filter","mySnippets","User",function(e,n,t,i,r,o,a){function s(){l.filtered=r("searchSnippets")(o,l.search),!l.search||!l.filtered[0]||l.snippetId&&l.snippetId===l.filtered[0].id||i.go("snippets.detail",{id:l.filtered[0].id})}var l=this;l.snippetId=parseInt(i.params.id),l.snippets=o,l.searchSnippets=s,l.searchSnippets(),l.isAuthenticated=e.isAuthenticated();var c=function(){l.isAuthenticated&&a.me().success(function(e){l.currentUser=e})};c(),t.$on("$stateChangeSuccess",function(e,n,t){return n.name.match(/snippets/)?(l.snippetId=parseInt(t.id,10),void(!l.snippetId&&l.filtered[0]&&i.go("snippets.detail",{id:l.filtered[0].id}))):null}),t.$on("snippetUpdated",function(e,n){o.some(function(e,t){return e.id===n.id?(o[t]=n,!0):!1})||o.unshift(n),s(),l.snippetId=n.id,i.go("snippets.detail",{id:n.id})}),t.$on("snippetDeleted",function(){if(i.is("snippets.detail")){for(var e=parseInt(i.params.id,10),n=0;n<l.snippets.length;n++)if(l.snippets[n].id===e){l.snippets.splice(n,1);break}for(n=0;n<l.filtered.length;n++)if(l.filtered[n].id===e){null!=l.filtered[n+1]?i.go("snippets.detail",{id:l.filtered[n+1].id}):null!=l.filtered[n-1]?i.go("snippets.detail",{id:l.filtered[n-1].id}):i.go("snippets"),l.filtered.splice(n,1);break}}}),t.$on("tagSelected",function(e,n){e.stopPropagation(),t.$apply(function(){l.search="#"+n.name,s()})})}]),angular.module("codexen.shared",["satellizer"]),angular.module("codexen.shared").constant("aceModes",["ABAP","ABC","ActionScript","ADA","Apache_Conf","AsciiDoc","Assembly_x86","AutoHotKey","BatchFile","C9Search","C_Cpp","Cirru","Clojure","Cobol","coffee","ColdFusion","CSharp","CSS","Curly","D","Dart","Diff","Dockerfile","Dot","Dummy","DummySyntax","Eiffel","EJS","Elixir","Elm","Erlang","Forth","FTL","Gcode","Gherkin","Gitignore","Glsl","golang","Groovy","HAML","Handlebars","Haskell","haXe","HTML","HTML_Ruby","INI","Io","Jack","Jade","Java","JavaScript","JSON","JSONiq","JSP","JSX","Julia","LaTeX","Lean","LESS","Liquid","Lisp","LiveScript","LogiQL","LSL","Lua","LuaPage","Lucene","Makefile","Markdown","Mask","MATLAB","MEL","MUSHCode","MySQL","Nix","ObjectiveC","OCaml","Pascal","Perl","pgSQL","PHP","Powershell","Praat","Prolog","Properties","Protobuf","Python","R","RDoc","RHTML","Ruby","Rust","SASS","SCAD","Scala","Scheme","SCSS","SH","SJS","Smarty","snippets","Soy_Template","Space","SQL","SQLServer","Stylus","SVG","Tcl","Tex","Text","Textile","Toml","Twig","Typescript","Vala","VBScript","Velocity","Verilog","VHDL","XML","XQuery","YAML","Django"]),angular.module("codexen.shared").constant("apiUrl","http://codexen-server-dev.elasticbeanstalk.com/"),angular.module("codexen.shared").config(["$authProvider","$httpProvider","apiUrl",function(e,n,t){e.baseUrl=t,n.defaults.useXDomain=!0,delete n.defaults.headers.common["X-Requested-With"]}]),angular.module("ui.ace",[]).constant("uiAceConfig",{}).directive("uiAce",["uiAceConfig",function(e){if(angular.isUndefined(window.ace))throw new Error("ui-ace need ace to work... (o rly?)");var n=function(e,n,t){if(angular.isDefined(t.workerPath)){var i=window.ace.require("ace/config");i.set("workerPath",t.workerPath)}angular.isDefined(t.require)&&t.require.forEach(function(e){window.ace.require(e)}),angular.isDefined(t.showGutter)&&e.renderer.setShowGutter(t.showGutter),angular.isDefined(t.useWrapMode)&&n.setUseWrapMode(t.useWrapMode),angular.isDefined(t.showInvisibles)&&e.renderer.setShowInvisibles(t.showInvisibles),angular.isDefined(t.showIndentGuides)&&e.renderer.setDisplayIndentGuides(t.showIndentGuides),angular.isDefined(t.useSoftTabs)&&n.setUseSoftTabs(t.useSoftTabs),angular.isDefined(t.showPrintMargin)&&e.setShowPrintMargin(t.showPrintMargin),angular.isDefined(t.maxLines)&&(t.maxLines<0&&(t.maxLines=1/0),e.setOptions({maxLines:t.maxLines})),angular.isDefined(t.disableSearch)&&t.disableSearch&&e.commands.addCommands([{name:"unfind",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(){return!1},readOnly:!0}]),angular.isString(t.theme)&&e.setTheme("ace/theme/"+t.theme),angular.isString(t.mode)&&n.setMode("ace/mode/"+t.mode),angular.isDefined(t.firstLineNumber)&&(angular.isNumber(t.firstLineNumber)?n.setOption("firstLineNumber",t.firstLineNumber):angular.isFunction(t.firstLineNumber)&&n.setOption("firstLineNumber",t.firstLineNumber()));var r,o;if(angular.isDefined(t.advanced))for(r in t.advanced)o={name:r,value:t.advanced[r]},e.setOption(o.name,o.value);if(angular.isDefined(t.rendererOptions))for(r in t.rendererOptions)o={name:r,value:t.rendererOptions[r]},e.renderer.setOption(o.name,o.value);angular.forEach(t.callbacks,function(n){angular.isFunction(n)&&n(e)})};return{restrict:"EA",require:"?ngModel",link:function(t,i,r,o){var a=e.ace||{},s=angular.extend({},a,t.$eval(r.uiAce)),l=window.ace.edit(i[0]);l.$blockScrolling=1/0;var c,u,d=l.getSession(),p=function(){var e=arguments[0],n=Array.prototype.slice.call(arguments,1);angular.isDefined(e)&&t.$evalAsync(function(){if(!angular.isFunction(e))throw new Error("ui-ace use a function as callback.");e(n)})},f={onChange:function(e){return function(n){var i=d.getValue();!o||i===o.$viewValue||t.$$phase||t.$root.$$phase||t.$evalAsync(function(){o.$setViewValue(i)}),p(e,n,l)}},onBlur:function(e){return function(){p(e,l)}}};r.$observe("readonly",function(e){l.setReadOnly(!!e||""===e)}),o&&(o.$formatters.push(function(e){if(angular.isUndefined(e)||null===e)return"";if(angular.isObject(e)||angular.isArray(e))throw new Error("ui-ace cannot use an object or an array as a model");return e}),o.$render=function(){d.setValue(o.$viewValue)});var m=function(e,i){e!==i&&(s=angular.extend({},a,t.$eval(r.uiAce)),s.callbacks=[s.onLoad],s.onLoad!==a.onLoad&&s.callbacks.unshift(a.onLoad),d.removeListener("change",c),c=f.onChange(s.onChange),d.on("change",c),l.removeListener("blur",u),u=f.onBlur(s.onBlur),l.on("blur",u),n(l,d,s))};t.$watch(r.uiAce,m,!0),m(a),i.on("$destroy",function(){l.session.$stopWorker(),l.destroy()}),t.$watch(function(){return[i[0].offsetWidth,i[0].offsetHeight]},function(){l.resize(),l.renderer.updateFull()},!0),t.Infinity=-1,t.focus=function(){l.focus()},t.addCommand=l.commands.addCommand,i.on("click",function(){l.focus()}),t.$on("insertRequested",function(e,n){var i=l.selection.getCursor(),r="";switch(i.column>0&&(r+="\n\n"),n){case"h1":l.insert(r+"# some heading\n\n");break;case"ul":l.insert(r+"- item1\n- item2\n- item3");break;case"ol":l.insert(r+"1. item1\n2. item2\n3. item3");break;case"a":l.insert(r+"[example.com](http://example.com)");break;case"table":l.insert(r+"First Header  | Second Header\n------------- | -------------\nContent Cell  | Content Cell\nContent Cell  | Content Cell\n")}t.$evalAsync(function(){o.$setViewValue(d.getValue())})}),t.$on("insertSnippetRequested",function(e,n){var i=l.selection.getCursor(),r="";i.column>0&&(r+="\n\n"),l.insert(r+"```\n"+n.content+"\n```\n> [snippet#"+n.id+"](#/snippets/"+n.id+")\n\n"),t.$evalAsync(function(){o.$setViewValue(d.getValue())})})}}}]),angular.module("codexen.shared").factory("Snippet",["$http","$auth","apiUrl",function(e,n,t){var i=function(n){var i=t+"snippets/search";return e.get(i,{params:{user:n}})},r=function(n){var i=t+"snippets/my";return e.get(i,{params:n})},o=function(n){var i=t+"snippets/create";return e.post(i,n)},a=function(n,i){var r=t+"snippets/id/"+n;return e.get(r,{params:i})},s=function(n,i){var r=t+"snippets/id/"+n;return e.put(r,i)},l=function(n){var i=t+"snippets/id/"+n;return e["delete"](i)};return{findByUser:i,findMine:r,create:o,show:a,"delete":l,update:s}}]);